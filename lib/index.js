module.exports=function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(r){return e[r]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=6)}([function(e,r){e.exports=require("tesrasdk-ts")},function(e,r){e.exports=require("@ledgerhq/hw-transport-u2f")},function(e,r){e.exports=require("uuid")},function(e,r){e.exports=require("promise-timeout")},function(e,r){e.exports=require("@ledgerhq/hw-transport-node-hid")},function(e,r){e.exports=require("elliptic")},function(e,r,t){"use strict";t.r(r);var n=t(5),o=t(0),u=t(4),a=t.n(u),i=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}();function s(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){return function n(o,u){try{var a=r[o](u),i=a.value}catch(e){return void t(e)}if(!a.done)return Promise.resolve(i).then(function(e){n("next",e)},function(e){n("throw",e)});e(i)}("next")})}}var c=function(){function e(){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"open",value:function(){var e=s(regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.isSupported();case 2:if(e.sent){e.next=5;break}throw new Error("Your computer does not support the ledger!");case 5:return e.next=7,a.a.list();case 7:if(0!==(r=e.sent).length){e.next=10;break}throw new Error("USB Error: No device found.");case 10:return e.next=12,a.a.open(r[0]);case 12:this.delegate=e.sent,this.delegate.setDebugMode(!0),this.delegate.setScrambleKey(null),this.delegate.setExchangeTimeout(5e3);case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"close",value:function(){var e=s(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.delegate.close();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=s(regeneratorRuntime.mark(function e(r,t,n){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.delegate.send(r.cla,r.ins,r.p1,r.p2,Buffer.from(t,"hex"),n);case 2:return o=e.sent,e.abrupt("return",o.toString("hex"));case 4:case"end":return e.stop()}},e,this)}));return function(r,t,n){return e.apply(this,arguments)}}()}]),e}();function f(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){return function n(o,u){try{var a=r[o](u),i=a.value}catch(e){return void t(e)}if(!a.done)return Promise.resolve(i).then(function(e){n("next",e)},function(e){n("throw",e)});e(i)}("next")})}}var p=new c;function l(e){p=e}var d=function(){var e=f(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h(0,!1);case 3:return e.abrupt("return",!0);case 6:return e.prev=6,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 10:case"end":return e.stop()}},e,this,[[0,6]])}));return function(){return e.apply(this,arguments)}}(),h=function(){var e=f(regeneratorRuntime.mark(function e(r,t){var n,o,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.open();case 2:return e.prev=2,n=m(r,t),o={cla:128,ins:4,p1:0,p2:0},e.next=7,p.send(o,n,[y]);case 7:return u=e.sent,e.abrupt("return",u.substring(0,130));case 11:throw e.prev=11,e.t0=e.catch(2),R(e.t0);case 14:return e.prev=14,e.next=17,p.close();case 17:return e.finish(14);case 18:case"end":return e.stop()}},e,this,[[2,11,14,18]])}));return function(r,t){return e.apply(this,arguments)}}(),v=function(){var e=f(regeneratorRuntime.mark(function e(r,t,n){var o,u,a,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.open();case 2:if(e.prev=2,o=m(r,t),0!==(u=(n+=o).match(/.{1,510}/g)||[]).length){e.next=8;break}throw new Error("Invalid data provided: "+n);case 8:a=null,i=0;case 10:if(!(i<u.length)){e.next=18;break}return s={cla:128,ins:2,p1:i===u.length-1?128:0,p2:0},e.next=14,p.send(s,u[i],[y]);case 14:a=e.sent;case 15:i++,e.next=10;break;case 18:if(null!==a&&"9000"!==a){e.next=20;break}throw new Error("No more data but Ledger did not return signature!");case 20:return e.abrupt("return",g(a));case 23:throw e.prev=23,e.t0=e.catch(2),R(e.t0);case 26:return e.prev=26,e.next=29,p.close();case 29:return e.finish(26);case 30:case"end":return e.stop()}},e,this,[[2,23,26,30]])}));return function(r,t,n){return e.apply(this,arguments)}}();function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments[1],t=e.toString(16).padStart(8,"0");return"8000002C"+(r?"80000378":"80000400")+"8000000000000000"+t}function g(e){var r=new o.utils.StringReader(e);r.read(2),r.read(1);var t=r.readNextBytes();return r.read(1),[t,r.readNextBytes()].map(function(e){return e.length<64&&(e=e.padStart(64,"0")),e.length>64&&(e=e.substr(-64)),e}).join("")}var y=36864,w=27912,x=28160,b=27013,k=27911;function R(e){switch(e.statusCode){case x:e.message="Your NEO app is closed! Please login.";break;case w:e.message="Your transaction is too big for the ledger to sign!";break;case b:e.message="You have denied the transaction on your ledger.";break;case k:e.message="Error parsing transaction. Make sure your NEO app version is up to date."}return e}function S(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){return function n(o,u){try{var a=r[o](u),i=a.value}catch(e){return void t(e)}if(!a.done)return Promise.resolve(i).then(function(e){n("next",e)},function(e){n("throw",e)});e(i)}("next")})}}var E=o.Crypto.CurveLabel,P=o.Crypto.KeyParameters,C=o.Crypto.KeyType,L=o.Crypto.PrivateKey,O=o.Crypto.PublicKey,j=o.Crypto.Signature,T=o.Crypto.SignatureScheme,K=function(){var e=S(regeneratorRuntime.mark(function e(r,t){var o,u,a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(r,t);case 2:return o=e.sent,u=new n.ec(E.SECP256R1.preset),a=u.keyFromPublic(o,"hex"),i=a.getPublic(!0,"hex"),e.abrupt("return",M(r,t,i));case 7:case"end":return e.stop()}},e,this)}));return function(r,t){return e.apply(this,arguments)}}();function M(e,r,t){var n=new L("",C.ECDSA,new P(E.SECP256R1)),o=n;return o.index=e,o.neo=r,o.publicKey=new O(t,n.algorithm,n.parameters),o.type="LEDGER",o.sign=function(e,r,t){throw new Error("Synchronious signing is not supported with Ledger.")},o.signAsync=function(){var e=S(regeneratorRuntime.mark(function e(t,n,o){var u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=T.ECDSAwithSHA256),this.isSchemaSupported(n)){e.next=3;break}throw new Error("Signature schema does not match key type.");case 3:if("string"==typeof t){e.next=7;break}t=t.serializeUnsignedData(),e.next=8;break;case 7:throw new Error("Only Signable signature is supported in ledger");case 8:return e.next=10,v(this.index,r,t);case 10:return u=e.sent,e.abrupt("return",new j(n,u,o));case 12:case"end":return e.stop()}},e,this)}));return function(r,t,n){return e.apply(this,arguments)}}(),o.getPublicKey=function(){return this.publicKey},o.isSchemaSupported=function(e){return e===T.ECDSAwithSHA256},o.serializeJson=function(){return{algorithm:this.algorithm.label,external:{index:this.index,neo:this.neo,pKey:this.publicKey.key,type:"LEDGER"},parameters:this.parameters.serializeJson(),key:null}},o.decrypt=function(e,r,t,n){return this},o.encrypt=function(e,r,t,n){return this},o}var D=t(3),A=t(2),q=function(){return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,r){var t=[],n=!0,o=!1,u=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done)&&(t.push(a.value),!r||t.length!==r);n=!0);}catch(e){o=!0,u=e}finally{try{!n&&i.return&&i.return()}finally{if(o)throw u}}return t}(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),I=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}();function N(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){return function n(o,u){try{var a=r[o](u),i=a.value}catch(e){return void t(e)}if(!a.done)return Promise.resolve(i).then(function(e){n("next",e)},function(e){n("throw",e)});e(i)}("next")})}}var B=function(){function e(r){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.forwarderUrl=r,this.debug=t}return I(e,[{key:"open",value:function(){var e=N(regeneratorRuntime.mark(function e(){var r,t,n,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(this.forwarderUrl,this.debug);case 2:return r=e.sent,t=q(r,2),n=t[0],o=t[1],this.channel=n,this.iframe=o,e.next=10,z(this.channel,{id:Object(A.v4)(),method:"open"});case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"close",value:function(){var e=N(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(this.channel,{id:Object(A.v4)(),method:"close"});case 2:return e.next=4,_(this.channel,this.iframe);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=N(regeneratorRuntime.mark(function e(r,t,n){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(this.channel,{id:Object(A.v4)(),method:"send",cla:r.cla,ins:r.ins,p1:r.p1,p2:r.p2,data:t,statusList:n},3e4);case 2:return o=e.sent,e.abrupt("return",o.result);case 4:case"end":return e.stop()}},e,this)}));return function(r,t,n){return e.apply(this,arguments)}}()}]),e}(),U=function(){var e=N(regeneratorRuntime.mark(function e(r,t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Promise(function(e,n){var o=new MessageChannel,u=document.createElement("iframe");o.port1.addEventListener("message",function r(n){t&&console.log("Received ready message from Iframe.",n),"ready"===n.data?(o.port1.removeEventListener("message",r),e([o,u])):t&&console.error('First event on Iframe port was not "ready"')}),o.port1.start(),u.src=r,u.setAttribute("style","display:none"),u.addEventListener("load",function(){t&&console.log("Load event of Iframe fired."),null!=u&&null!=u.contentWindow?u.contentWindow.postMessage("init","*",[o.port2]):n("Can not find Ledger forwarder IFrame.")}),document.body.appendChild(u)}),e.abrupt("return",Object(D.timeout)(n,2e3));case 2:case"end":return e.stop()}},e,this)}));return function(r,t){return e.apply(this,arguments)}}(),_=function(){var e=N(regeneratorRuntime.mark(function e(r,t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Promise(function(e,n){null!=t&&null!=t.contentWindow?(t.contentWindow.postMessage("close","*"),r.port1.close(),document.body.removeChild(t),e()):n("Can not find Ledger forwarder IFrame")}),e.abrupt("return",Object(D.timeout)(n,2e3));case 2:case"end":return e.stop()}},e,this)}));return function(r,t){return e.apply(this,arguments)}}(),z=function(){var e=N(regeneratorRuntime.mark(function e(r,t){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Promise(function(e){r.port1.addEventListener("message",function n(o){var u=o.data;u.id===t.id&&(r.port1.removeEventListener("message",n),e(u))}),r.port1.postMessage(t)}),e.abrupt("return",Object(D.timeout)(n,o));case 2:case"end":return e.stop()}},e,this)}));return function(r,t){return e.apply(this,arguments)}}(),F=t(1),Y=t.n(F),W=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}();function G(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){return function n(o,u){try{var a=r[o](u),i=a.value}catch(e){return void t(e)}if(!a.done)return Promise.resolve(i).then(function(e){n("next",e)},function(e){n("throw",e)});e(i)}("next")})}}var H=function(){function e(){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e)}return W(e,[{key:"open",value:function(){var e=G(regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.a.isSupported();case 2:if(e.sent){e.next=5;break}throw new Error("Your computer does not support the ledger!");case 5:return e.next=7,Y.a.list();case 7:if(0!==(r=e.sent).length){e.next=10;break}throw new Error("USB Error: No device found.");case 10:return e.next=12,Y.a.open(r[0]);case 12:this.delegate=e.sent,this.delegate.setDebugMode(!0),this.delegate.setScrambleKey("TST"),this.delegate.setExchangeTimeout(5e3);case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"close",value:function(){var e=G(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.delegate.close();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=G(regeneratorRuntime.mark(function e(r,t,n){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.delegate.send(r.cla,r.ins,r.p1,r.p2,Buffer.from(t,"hex"),n);case 2:return o=e.sent,e.abrupt("return",o.toString("hex"));case 4:case"end":return e.stop()}},e,this)}));return function(r,t,n){return e.apply(this,arguments)}}()}]),e}(),J=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}();var Q=function(){function e(){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e)}return J(e,[{key:"getType",value:function(){return"LEDGER"}},{key:"deserialize",value:function(e){return M(e.external.index,e.external.neo,e.external.pKey)}}]),e}();t.d(r,"create",function(){return K}),t.d(r,"LedgerTransportNode",function(){return c}),t.d(r,"LedgerTransportIframe",function(){return B}),t.d(r,"LedgerTransportU2F",function(){return H}),t.d(r,"LedgerKeyDeserializer",function(){return Q}),t.d(r,"setLedgerTransport",function(){return l}),t.d(r,"isLedgerSupported",function(){return d}),t.d(r,"getPublicKey",function(){return h}),t.d(r,"computesSignature",function(){return v})}]);
//# sourceMappingURL=index.js.map